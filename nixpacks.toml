[phases.setup]
nixPkgs = ["python311", "python311Packages.pip", "python311Packages.setuptools"]
# opencv-python-headless için minimal sistem bağımlılıkları
aptPkgs = [
    "libgl1",
    "libglib2.0-0",
    "libsm6",
    "libxext6",
    "libxrender1"
]

[phases.install]
cmds = ["pip install --no-cache-dir -r backend/requirements.txt"]

[phases.build]
cmds = []

[start]
# Sync worker - gevent Railway'de çalışmıyor
# timeout 900s (15dk), graceful-timeout 60s - Railway için optimize
cmd = "gunicorn backend.app:app --bind 0.0.0.0:$PORT --workers 1 --threads 4 --timeout 900 --graceful-timeout 60 --keepalive 5"
